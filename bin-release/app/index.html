<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>Tripleonetech Login</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	</head>
	<body>
    <!--login modal-->
    <div id="loginModal" class="modal show" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h1 class="text-center">Login</h1>
          </div>
          <div class="modal-body">
              <div class="form-group">
                <input type="text" class="form-control input-lg" placeholder="UserName" id="username">
              </div>
              <div class="form-group">
                <input type="password" class="form-control input-lg" placeholder="Password" id="password">
              </div>
              <div class="form-group">
                <button type="submit" class="btn btn-primary btn-lg btn-block" onclick="login()" id="loginBtn">Sign In</button>
              </div>
          </div>
      </div>
      </div>
    </div>
	  <!-- script references -->
    <script>
      const { remote } = require('electron');
      const request = require('request')
      function login() {
          const username = document.getElementById('username').value
          const password = document.getElementById('password').value
          const homeUrl = remote.getGlobal('sharedObj').homeUrl || "http://www.demo.tripleonetech.com/";
          request({
            url: 'http://localhost:3000/login',
            method: 'POST',
            json: { username, password },
          }, (err, res, body) => {
            if (err || res.statusCode !== 200) {
              alert('Login failed')
            } else {
              const { localServer, port } = body.data
              // TODO: send shadowsocks info back to main.js
              window.location.href = homeUrl
            }
          })

          // if (userName.toLowerCase() === 'admin' && password === 'admin') {
          //   window.location.href = homeUrl
          // } else {
          //   alert('Login failed')
          // }
      }

      document.getElementById("password")
          .addEventListener("keyup", function(event) {
          event.preventDefault();
          if (event.keyCode == 13) {
              document.getElementById("loginBtn").click();
          }
      });

      window.onload = function() {
        document.getElementById("username").focus();
      };
    </script>
		<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>-->
		<!--<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
	</body>
</html>